(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{87:function(e,r,t){"use strict";t.r(r),t.d(r,"frontMatter",(function(){return o})),t.d(r,"metadata",(function(){return i})),t.d(r,"toc",(function(){return u})),t.d(r,"default",(function(){return d}));var n=t(3),a=t(7),c=(t(0),t(99)),o={id:"curried-produce",title:"Curried producers"},i={unversionedId:"curried-produce",id:"curried-produce",isDocsHomePage:!1,title:"Curried producers",description:"<div",source:"@site/docs/curried-produce.mdx",slug:"/curried-produce",permalink:"/immer/curried-produce",editUrl:"https://github.com/immerjs/immer/edit/master/website/docs/curried-produce.mdx",version:"current",sidebar:"Immer",previous:{title:"Using produce",permalink:"/immer/produce"},next:{title:"Example Reducer",permalink:"/immer/example-reducer"}},u=[],p={toc:u};function d(e){var r=e.components,t=Object(a.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},p,t,{components:r,mdxType:"MDXLayout"}),Object(c.b)("center",null,Object(c.b)("div",{"data-ea-publisher":"immerjs","data-ea-type":"image",className:"horizontal bordered"}))," ",Object(c.b)("details",null,Object(c.b)("summary",{className:"egghead-summary"},"egghead.io lesson 6: Simplify code by using curried _reduce_"),Object(c.b)("br",null),Object(c.b)("div",null,Object(c.b)("iframe",{width:"760",height:"427",scrolling:"no",src:"https://egghead.io/lessons/javascript-simplify-immer-producer-functions-using-currying/embed"})),Object(c.b)("a",{className:"egghead-link",href:"https://egghead.io/lessons/javascript-simplify-immer-producer-functions-using-currying"},"Hosted on egghead.io")),Object(c.b)("p",null,"Passing a function as the first argument to ",Object(c.b)("inlineCode",{parentName:"p"},"produce")," is intended to be used for currying. This means that you get a pre-bound producer that only needs a state to produce the value from. The producer function gets passed in the draft and any further arguments that were passed to the curried function."),Object(c.b)("p",null,"For example:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-javascript"},"// mapper will be of signature (state, index) => state\nconst mapper = produce((draft, index) => {\n    draft.index = index\n})\n\n// example usage\nconsole.dir([{}, {}, {}].map(mapper))\n//[{index: 0}, {index: 1}, {index: 2}])\n")),Object(c.b)("p",null,"This mechanism can also nicely be leveraged to further simplify our example reducer:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-javascript"},'import produce from "immer"\n\nconst byId = produce((draft, action) => {\n    switch (action.type) {\n        case RECEIVE_PRODUCTS:\n            action.products.forEach(product => {\n                draft[product.id] = product\n            })\n            return\n    }\n})\n')),Object(c.b)("p",null,"Note that ",Object(c.b)("inlineCode",{parentName:"p"},"state")," is now factored out (the created reducer will accept a state, and invoke the bound producer with it)."),Object(c.b)("p",null,"If you want to initialize an uninitialized state using this construction, you can do so by passing the initial state as second argument to ",Object(c.b)("inlineCode",{parentName:"p"},"produce"),":"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-javascript"},'import produce from "immer"\n\nconst byId = produce(\n    (draft, action) => {\n        switch (action.type) {\n            case RECEIVE_PRODUCTS:\n                action.products.forEach(product => {\n                    draft[product.id] = product\n                })\n                return\n        }\n    },\n    {\n        1: {id: 1, name: "product-1"}\n    }\n)\n')))}d.isMDXComponent=!0},99:function(e,r,t){"use strict";t.d(r,"a",(function(){return s})),t.d(r,"b",(function(){return b}));var n=t(0),a=t.n(n);function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){c(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=a.a.createContext({}),d=function(e){var r=a.a.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},s=function(e){var r=d(e.components);return a.a.createElement(p.Provider,{value:r},e.children)},l={inlineCode:"code",wrapper:function(e){var r=e.children;return a.a.createElement(a.a.Fragment,{},r)}},m=a.a.forwardRef((function(e,r){var t=e.components,n=e.mdxType,c=e.originalType,o=e.parentName,p=u(e,["components","mdxType","originalType","parentName"]),s=d(t),m=n,b=s["".concat(o,".").concat(m)]||s[m]||l[m]||c;return t?a.a.createElement(b,i(i({ref:r},p),{},{components:t})):a.a.createElement(b,i({ref:r},p))}));function b(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var c=t.length,o=new Array(c);o[0]=m;var i={};for(var u in r)hasOwnProperty.call(r,u)&&(i[u]=r[u]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var p=2;p<c;p++)o[p]=t[p];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);